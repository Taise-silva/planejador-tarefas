<!-- No seu HTML, certifique-se de ter um container para o calendário -->
<div id="calendario-container"></div>

<script type="module">
  // 1. Importações do Firebase
  import { initializeApp } from "https://www.gstatic.com";
  import { getDatabase, ref, push, onValue } from "https://www.gstatic.com";

  // 2. Sua Configuração (Substitua pelos seus dados do Firebase Console)
  const firebaseConfig = {
    apiKey: "SUA_API_KEY",
    authDomain: "SEU_PROJETO.firebaseapp.com",
    databaseURL: "https://SEU_PROJETO.firebaseio.com",
    projectId: "SEU_PROJETO",
    storageBucket: "SEU_PROJETO.appspot.com",
    appId: "SEU_APP_ID"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  const tarefasRef = ref(db, 'tarefas');

  // 3. Função para Gerar o Calendário (Sem apagar os dias)
  function gerarCalendario() {
    const container = document.getElementById('calendario-container');
    container.innerHTML = ""; // Limpa apenas na primeira carga
    
    const diasNoMes = 31; // Exemplo simplificado para Janeiro
    for (let i = 1; i <= diasNoMes; i++) {
      const divDia = document.createElement('div');
      divDia.classList.add('dia');
      divDia.id = `dia-${i}`;
      divDia.innerHTML = `<span>${i}</span><ul class="lista-tarefas-dia"></ul>`;
      
      // Evento para adicionar tarefa ao clicar no dia
      divDia.onclick = () => {
        const texto = prompt(`Nova tarefa para o dia ${i}:`);
        if (texto) salvarTarefaNoFirebase(i, texto);
      };
      
      container.appendChild(divDia);
    }
  }

  // 4. Salvar no Firebase (Envia para nuvem)
  function salvarTarefaNoFirebase(dia, texto) {
    push(tarefasRef, {
      dia: dia,
      texto: texto,
      concluida: false,
      timestamp: Date.now()
    });
  }

  // 5. Escutar o Firebase (Sincronização em tempo real para toda a equipe)
  onValue(tarefasRef, (snapshot) => {
    const dados = snapshot.val();
    
    // Limpar apenas as listas de tarefas dentro dos dias, sem remover os números dos dias
    document.querySelectorAll('.lista-tarefas-dia').forEach(ul => ul.innerHTML = "");

    if (dados) {
      Object.keys(dados).forEach(id => {
        const tarefa = dados[id];
        const listaUl = document.querySelector(`#dia-${tarefa.dia} .lista-tarefas-dia`);
        
        if (listaUl) {
          const li = document.createElement('li');
          li.textContent = tarefa.texto;
          if (tarefa.concluida) li.classList.add('concluida');
          listaUl.appendChild(li);
        }
      });
    }
  });

  // Inicializa o calendário ao carregar a página
  gerarCalendario();
</script>
